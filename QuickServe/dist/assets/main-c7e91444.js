(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();const u={services:[],init(s=[]){this.services=s,this.bindEvents(),this.renderServices()},bindEvents(){document.addEventListener("click",s=>{if(s.target.closest(".service-tile")){const t=s.target.closest(".service-tile").dataset.serviceId;this.handleServiceSelection(t)}})},renderServices(){const s=document.querySelector(".services-grid");s&&this.services.length>0&&(s.innerHTML=this.services.slice(0,8).map(e=>'<div class="service-tile" data-service-id="'+e.id+'"><div class="service-icon"><img src="'+e.image+'" alt="'+e.name+`" onerror="this.src='/services/default.jpg'"></div><h3>`+e.name+"</h3><p>â‚¹"+e.price+'</p><span class="service-category">'+e.category+"</span></div>").join(""))},handleServiceSelection(s){const e=this.services.find(t=>t.id==s);e&&console.log("Selected service:",e)}},p={providers:[],init(s=[]){this.providers=s,this.bindEvents(),this.renderProviders()},bindEvents(){console.log("Providers view events bound")},renderProviders(){console.log("Rendering providers:",this.providers.length)}},E={init(){this.bindEvents()},bindEvents(){console.log("Booking view events bound")}};class g{constructor(){this.baseURL=this.getBaseURL(),this.retryAttempts=3,this.timeoutDuration=1e4,this.authToken=Storage.getItem("authToken"),this.refreshToken=Storage.getItem("refreshToken"),this.interceptors={request:[],response:[]},this.initializeInterceptors()}getBaseURL(){if(typeof window<"u"){const t=window.ENV&&window.ENV.API_BASE_URL;if(typeof t=="string")return t.trim()===""?null:t;const i=document.querySelector&&document.querySelector('meta[name="api-base-url"]');return i&&i.content?i.content||null:window.location.hostname.includes("staging")?"https://api-staging.quickserve.com/v1":"https://api.quickserve.com/v1"}const e={}.API_BASE_URL;return e&&e.trim()!==""?e:null}initializeInterceptors(){this.addRequestInterceptor(e=>(this.authToken&&(e.headers={...e.headers,Authorization:`Bearer ${this.authToken}`}),e.headers["X-Correlation-ID"]=this.generateCorrelationId(),e.headers["X-Client-Version"]="1.0.0",e.headers["X-Platform"]=this.getPlatform(),e)),this.addResponseInterceptor(e=>e,async e=>{var i;const t=e.config;if(((i=e.response)==null?void 0:i.status)===401&&!t._retry){t._retry=!0;try{return await this.refreshAuthToken(),this.request(t)}catch(r){throw this.handleAuthFailure(),r}}return Promise.reject(e)})}addRequestInterceptor(e){this.interceptors.request.push(e)}addResponseInterceptor(e,t){this.interceptors.response.push({successHandler:e,errorHandler:t})}async request(e){let t={...e};for(const r of this.interceptors.request)t=r(t)||t;t.headers={"Content-Type":"application/json",Accept:"application/json",...t.headers};let i;for(let r=1;r<=this.retryAttempts;r++)try{let a=await this.makeRequest(t);for(const c of this.interceptors.response)try{a=c.successHandler(a)||a}catch(l){console.warn("Response interceptor error:",l)}return a}catch(o){i=o;for(const a of this.interceptors.response)if(a.errorHandler)try{const c=await a.errorHandler(o);if(c)return c}catch(c){console.warn("Error interceptor failed:",c)}if(this.shouldNotRetry(o))break;r<this.retryAttempts&&await this.delay(this.getRetryDelay(r))}throw i}async makeRequest(e){const t=new AbortController,i=setTimeout(()=>t.abort(),this.timeoutDuration);try{const r=e.url.startsWith("http")?e.url:this.baseURL?`${this.baseURL}${e.url}`:(()=>{throw new h(400,"API disabled",{message:"API base URL not set"})})(),o=await fetch(r,{method:e.method||"GET",headers:e.headers,body:e.data?JSON.stringify(e.data):void 0,signal:t.signal,...e});if(clearTimeout(i),!o.ok)throw new h(o.status,o.statusText,await this.parseErrorResponse(o));return{data:await this.parseResponse(o),status:o.status,headers:o.headers}}catch(r){throw clearTimeout(i),r.name==="AbortError"?new h(408,"Request Timeout",{message:"Request timed out"}):r}}async parseResponse(e){const t=e.headers.get("content-type");return t!=null&&t.includes("application/json")?await e.json():t!=null&&t.includes("text/")?await e.text():await e.blob()}async parseErrorResponse(e){try{return await e.json()}catch{return{message:e.statusText}}}async get(e,t={},i={}){const r=new URLSearchParams(t).toString(),o=r?`${e}?${r}`:e;return this.request({method:"GET",url:o,...i})}async post(e,t={},i={}){return this.request({method:"POST",url:e,data:t,...i})}async put(e,t={},i={}){return this.request({method:"PUT",url:e,data:t,...i})}async patch(e,t={},i={}){return this.request({method:"PATCH",url:e,data:t,...i})}async delete(e,t={}){return this.request({method:"DELETE",url:e,...t})}async upload(e,t,i={}){return this.request({method:"POST",url:e,data:t,headers:{...i.headers},...i})}async refreshAuthToken(){if(!this.refreshToken)throw new Error("No refresh token available");try{const e=await fetch(`${this.baseURL}/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.refreshToken}`}});if(!e.ok)throw new Error("Token refresh failed");const t=await e.json();return this.setAuthTokens(t.accessToken,t.refreshToken),t.accessToken}catch(e){throw console.error("Token refresh failed:",e),e}}setAuthTokens(e,t){this.authToken=e,this.refreshToken=t,Storage.setItem("authToken",e),t&&Storage.setItem("refreshToken",t)}clearAuthTokens(){this.authToken=null,this.refreshToken=null,Storage.removeItem("authToken"),Storage.removeItem("refreshToken")}handleAuthFailure(){this.clearAuthTokens(),typeof window<"u"&&(window.location.href="/login"),document.dispatchEvent(new CustomEvent("auth:failure"))}shouldNotRetry(e){if(e instanceof h){const t=e.status;return t>=400&&t<500&&t!==408&&t!==429}return!1}getRetryDelay(e){return Math.pow(2,e-1)*1e3}delay(e){return new Promise(t=>setTimeout(t,e))}generateCorrelationId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}getPlatform(){if(typeof window>"u")return"server";const e=navigator.userAgent;return/Mobile|Android|iPhone|iPad/.test(e)?"mobile":"desktop"}async healthCheck(){try{return(await this.get("/health")).data}catch(e){throw console.error("Health check failed:",e),e}}async getStatus(){try{return(await this.get("/status")).data}catch(e){return console.error("Status check failed:",e),{status:"unknown",error:e.message}}}}class h extends Error{constructor(e,t,i={}){super(i.message||t),this.name="ApiError",this.status=e,this.statusText=t,this.data=i}}const n={AUTH:{LOGIN:"/auth/login",REGISTER:"/auth/register",LOGOUT:"/auth/logout",REFRESH:"/auth/refresh",VERIFY_EMAIL:"/auth/verify-email",FORGOT_PASSWORD:"/auth/forgot-password",RESET_PASSWORD:"/auth/reset-password"},USERS:{PROFILE:"/users/profile",UPDATE_PROFILE:"/users/profile",UPLOAD_AVATAR:"/users/avatar",PREFERENCES:"/users/preferences",ADDRESSES:"/users/addresses"},SERVICES:{LIST:"/services",DETAILS:s=>`/services/${s}`,SEARCH:"/services/search",CATEGORIES:"/services/categories",FEATURED:"/services/featured"},PROVIDERS:{LIST:"/providers",DETAILS:s=>`/providers/${s}`,SEARCH:"/providers/search",REVIEWS:s=>`/providers/${s}/reviews`,AVAILABILITY:s=>`/providers/${s}/availability`},BOOKINGS:{CREATE:"/bookings",LIST:"/bookings",DETAILS:s=>`/bookings/${s}`,UPDATE:s=>`/bookings/${s}`,CANCEL:s=>`/bookings/${s}/cancel`,TRACK:s=>`/bookings/${s}/track`},PAYMENTS:{PROCESS:"/payments",HISTORY:"/payments/history",REFUND:s=>`/payments/${s}/refund`,METHODS:"/payments/methods"},REVIEWS:{CREATE:"/reviews",UPDATE:s=>`/reviews/${s}`,DELETE:s=>`/reviews/${s}`,HELPFUL:s=>`/reviews/${s}/helpful`},NOTIFICATIONS:{LIST:"/notifications",MARK_READ:s=>`/notifications/${s}/read`,MARK_ALL_READ:"/notifications/read-all",PREFERENCES:"/notifications/preferences"},ADMIN:{DASHBOARD:"/admin/dashboard",USERS:"/admin/users",PROVIDERS:"/admin/providers",BOOKINGS:"/admin/bookings",ANALYTICS:"/admin/analytics",SETTINGS:"/admin/settings"}};class f{constructor(e){this.api=e}async login(e){const t=await this.api.post(n.AUTH.LOGIN,e);return t.data.accessToken&&this.api.setAuthTokens(t.data.accessToken,t.data.refreshToken),t.data}async register(e){const t=await this.api.post(n.AUTH.REGISTER,e);return t.data.accessToken&&this.api.setAuthTokens(t.data.accessToken,t.data.refreshToken),t.data}async logout(){try{await this.api.post(n.AUTH.LOGOUT)}finally{this.api.clearAuthTokens()}}async verifyEmail(e){return this.api.post(n.AUTH.VERIFY_EMAIL,{token:e})}async forgotPassword(e){return this.api.post(n.AUTH.FORGOT_PASSWORD,{email:e})}async resetPassword(e,t){return this.api.post(n.AUTH.RESET_PASSWORD,{token:e,password:t})}}class m{constructor(e){this.api=e}async createBooking(e){return(await this.api.post(n.BOOKINGS.CREATE,e)).data}async getBookings(e={}){return(await this.api.get(n.BOOKINGS.LIST,e)).data}async getBookingDetails(e){return(await this.api.get(n.BOOKINGS.DETAILS(e))).data}async updateBooking(e,t){return(await this.api.patch(n.BOOKINGS.UPDATE(e),t)).data}async cancelBooking(e,t){return(await this.api.post(n.BOOKINGS.CANCEL(e),{reason:t})).data}async trackBooking(e){return(await this.api.get(n.BOOKINGS.TRACK(e))).data}}class w{constructor(e){this.api=e}async processPayment(e){return(await this.api.post(n.PAYMENTS.PROCESS,e)).data}async getPaymentHistory(e={}){return(await this.api.get(n.PAYMENTS.HISTORY,e)).data}async requestRefund(e,t){return(await this.api.post(n.PAYMENTS.REFUND(e),{reason:t})).data}async getPaymentMethods(){return(await this.api.get(n.PAYMENTS.METHODS)).data}}const d=new g,S=new f(d),y=new m(d),A=new w(d);window.ApiService=d;window.AuthApi=S;window.BookingApi=y;window.PaymentApi=A;window.API_ENDPOINTS=n;window.ApiError=h;console.log("ðŸ”Œ API Service layer initialized");class v{constructor(){this.currentView="home",this.services=[],this.providers=[],this.init()}async init(){try{this.showLoading(),await this.loadServices(),this.initializeViews(),this.setupEventListeners(),this.hideLoading(),this.showView("home")}catch(e){console.error("App initialization failed:",e),this.hideLoading(),this.showError("Failed to load application")}}async loadServices(){try{const e=await fetch("./services.json");this.services=await e.json()}catch(e){console.error("Failed to load services:",e),this.services=[]}}initializeViews(){u.init(this.services),p.init(this.providers),E.init()}setupEventListeners(){document.querySelectorAll(".category-link").forEach(i=>{i.addEventListener("click",r=>{r.preventDefault();const o=r.currentTarget.getAttribute("href").substring(1);this.showView(o)})});const e=document.getElementById("mobileMenuToggle");e&&e.addEventListener("click",this.toggleMobileMenu);const t=document.getElementById("globalSearch");t&&t.addEventListener("input",this.handleSearch.bind(this))}showView(e){document.querySelectorAll(".view").forEach(r=>{r.style.display="none"}),document.querySelectorAll(".category-link").forEach(r=>{r.classList.remove("active")});const t=document.getElementById(`${e}View`);t&&(t.style.display="block");const i=document.querySelector(`[href="#${e}"]`);i&&i.classList.add("active"),this.currentView=e}showLoading(){const e=document.getElementById("loadingScreen");e&&(e.style.display="flex")}hideLoading(){const e=document.getElementById("loadingScreen");e&&(e.style.display="none",console.log("Loading screen hidden by app.js"))}showError(e){console.error(e)}toggleMobileMenu(){document.querySelector(".nav-wrapper").classList.toggle("mobile-open")}handleSearch(e){const t=e.target.value.toLowerCase();console.log("Searching for:",t)}}document.addEventListener("DOMContentLoaded",()=>{window.quickServeApp=new v});
//# sourceMappingURL=main-c7e91444.js.map
